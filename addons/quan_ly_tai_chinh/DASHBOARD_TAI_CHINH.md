# ğŸ“Š DASHBOARD Tá»”NG Há»¢P TÃ€I CHÃNH - MODULE QLTC

## ğŸ“‹ Tá»•ng quan

Dashboard Tá»•ng há»£p TÃ i chÃ­nh lÃ  trung tÃ¢m quáº£n lÃ½ vÃ  theo dÃµi toÃ n bá»™ hoáº¡t Ä‘á»™ng tÃ i chÃ­nh trong module **qltc** (Quáº£n lÃ½ TÃ i chÃ­nh/Káº¿ toÃ¡n). Dashboard cung cáº¥p cÃ¡i nhÃ¬n tá»•ng quan, chi tiáº¿t vÃ  trá»±c quan vá»:

- ğŸ’° **Äá» xuáº¥t mua thiáº¿t bá»‹**
- ğŸ“¦ **TÃ i sáº£n vÃ  Kháº¥u hao**
- ğŸ“š **Sá»• cÃ¡i vÃ  BÃºt toÃ¡n**
- ğŸ“ˆ **Xu hÆ°á»›ng vÃ  PhÃ¢n tÃ­ch**
- ğŸ¢ **PhÃ¢n bá»• theo phÃ²ng ban**
- âš ï¸ **Cáº£nh bÃ¡o vÃ  ThÃ´ng bÃ¡o**

---

## ğŸ¯ Má»¥c tiÃªu

1. **Tá»•ng há»£p thÃ´ng tin**: Táº­p trung táº¥t cáº£ thÃ´ng tin tÃ i chÃ­nh quan trá»ng vÃ o má»™t mÃ n hÃ¬nh duy nháº¥t
2. **Trá»±c quan hÃ³a dá»¯ liá»‡u**: Biá»ƒu Ä‘á»“, sÆ¡ Ä‘á»“ giÃºp dá»… dÃ ng phÃ¢n tÃ­ch xu hÆ°á»›ng
3. **Há»— trá»£ quyáº¿t Ä‘á»‹nh**: Cung cáº¥p sá»‘ liá»‡u chÃ­nh xÃ¡c, ká»‹p thá»i cho quáº£n lÃ½
4. **Cáº£nh bÃ¡o chá»§ Ä‘á»™ng**: ThÃ´ng bÃ¡o cÃ¡c váº¥n Ä‘á» cáº§n xá»­ lÃ½ ngay
5. **Tiáº¿t kiá»‡m thá»i gian**: Giáº£m thá»i gian tÃ¬m kiáº¿m, tá»•ng há»£p bÃ¡o cÃ¡o

---

## ğŸ—ï¸ Cáº¥u trÃºc Dashboard

### ğŸ“Š View Kanban (Trang chÃ­nh)

Dashboard sá»­ dá»¥ng **Kanban view** Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c chá»‰ sá»‘ quan trá»ng dÆ°á»›i dáº¡ng tháº» (card) trá»±c quan:

#### 1. Pháº§n Header
- **TÃªn dashboard**: "Dashboard TÃ i chÃ­nh"
- **NgÃ y hiá»‡n táº¡i**: Tá»± Ä‘á»™ng cáº­p nháº­t

#### 2. Cáº£nh bÃ¡o (Alert Section)
Hiá»ƒn thá»‹ cÃ¡c cáº£nh bÃ¡o quan trá»ng vá»›i mÃ u vÃ ng:
- âš ï¸ **TÃ i sáº£n sáº¯p kháº¥u hao háº¿t**: TÃ i sáº£n cÃ²n giÃ¡ trá»‹ < 10%
- âš ï¸ **Äá» xuáº¥t quÃ¡ háº¡n**: Äá» xuáº¥t quÃ¡ ngÃ y dá»± kiáº¿n nháº­n

#### 3. Thá»‘ng kÃª Äá» xuáº¥t Mua
- **Tá»•ng Ä‘á» xuáº¥t**: Sá»‘ lÆ°á»£ng tá»•ng (nÃºt báº¥m lá»›n mÃ u xanh)
- **Chá» phÃª duyá»‡t**: Link Ä‘áº¿n danh sÃ¡ch Ä‘á» xuáº¥t chá»
- **ÄÃ£ phÃª duyá»‡t**: Link Ä‘áº¿n danh sÃ¡ch Ä‘Ã£ duyá»‡t
- **Tá»•ng giÃ¡ trá»‹**: Hiá»ƒn thá»‹ sá»‘ tiá»n

#### 4. Thá»‘ng kÃª TÃ i sáº£n
- **Tá»•ng tÃ i sáº£n**: Link xem táº¥t cáº£
- **TÃ i sáº£n hoáº¡t Ä‘á»™ng**: Link xem tÃ i sáº£n Ä‘ang hoáº¡t Ä‘á»™ng
- **GiÃ¡ trá»‹ cÃ²n láº¡i**: Tá»•ng giÃ¡ trá»‹ hiá»‡n táº¡i

#### 5. Thá»‘ng kÃª Kháº¥u hao
- **Kháº¥u hao thÃ¡ng nÃ y**: Sá»‘ tiá»n kháº¥u hao trong thÃ¡ng
- **Kháº¥u hao nÄƒm nÃ y**: Tá»•ng kháº¥u hao tá»« Ä‘áº§u nÄƒm

### ğŸ“‹ View Form (Chi tiáº¿t)

View Form chia thÃ nh **5 Tab** chÃ­nh:

---

### **Tab 1: ğŸ“Š Tá»•ng quan**

Hiá»ƒn thá»‹ toÃ n bá»™ sá»‘ liá»‡u thá»‘ng kÃª dáº¡ng báº£ng:

#### A. Äá» xuáº¥t Mua thiáº¿t bá»‹
- **Sá»‘ lÆ°á»£ng**:
  - Tá»•ng Ä‘á» xuáº¥t
  - Chá» phÃª duyá»‡t
  - ÄÃ£ phÃª duyá»‡t
  - Bá»‹ tá»« chá»‘i
  - ÄÃ£ mua
  
- **GiÃ¡ trá»‹**:
  - Tá»•ng giÃ¡ trá»‹ Ä‘á» xuáº¥t
  - GiÃ¡ trá»‹ chá» duyá»‡t
  - GiÃ¡ trá»‹ Ä‘Ã£ duyá»‡t

#### B. Thá»‘ng kÃª TÃ i sáº£n
- **Sá»‘ lÆ°á»£ng**:
  - Tá»•ng tÃ i sáº£n
  - TÃ i sáº£n hoáº¡t Ä‘á»™ng
  - TÃ i sáº£n táº¡m dá»«ng
  - TÃ i sáº£n kháº¥u hao háº¿t
  
- **GiÃ¡ trá»‹**:
  - Tá»•ng giÃ¡ trá»‹ tÃ i sáº£n (ban Ä‘áº§u)
  - Tá»•ng kháº¥u hao tÃ­ch lÅ©y
  - Tá»•ng giÃ¡ trá»‹ cÃ²n láº¡i

#### C. Kháº¥u hao
- Kháº¥u hao thÃ¡ng nÃ y
- Kháº¥u hao quÃ½ nÃ y
- Kháº¥u hao nÄƒm nÃ y

#### D. Sá»• cÃ¡i
- Tá»•ng bÃºt toÃ¡n
- BÃºt toÃ¡n thÃ¡ng nÃ y
- Tá»•ng ná»£
- Tá»•ng cÃ³

---

### **Tab 2: ğŸ“ˆ Xu hÆ°á»›ng**

Biá»ƒu Ä‘á»“ trá»±c quan hÃ³a xu hÆ°á»›ng 12 thÃ¡ng gáº§n nháº¥t:

#### 1. Biá»ƒu Ä‘á»“ Kháº¥u hao (Line Chart)
- **Trá»¥c X**: ThÃ¡ng (MM/YYYY)
- **Trá»¥c Y**: Sá»‘ tiá»n kháº¥u hao
- **Má»¥c Ä‘Ã­ch**: Theo dÃµi xu hÆ°á»›ng kháº¥u hao tÄƒng/giáº£m theo thá»i gian

#### 2. Biá»ƒu Ä‘á»“ Mua sáº¯m (Bar Chart)
- **Trá»¥c X**: ThÃ¡ng (MM/YYYY)
- **Trá»¥c Y 1**: GiÃ¡ trá»‹ mua sáº¯m
- **Trá»¥c Y 2**: Sá»‘ lÆ°á»£ng Ä‘á» xuáº¥t
- **Má»¥c Ä‘Ã­ch**: PhÃ¢n tÃ­ch chu ká»³ mua sáº¯m, dá»± Ä‘oÃ¡n nhu cáº§u

---

### **Tab 3: ğŸ¢ PhÃ²ng ban**

PhÃ¢n tÃ­ch phÃ¢n bá»• tÃ i sáº£n vÃ  chi phÃ­ theo tá»«ng phÃ²ng ban:

#### A. Báº£ng chi tiáº¿t (Tree View)
CÃ¡c cá»™t:
- **PhÃ²ng ban**
- **Sá»‘ tÃ i sáº£n**: Tá»•ng sá»‘ tÃ i sáº£n cá»§a phÃ²ng
- **GiÃ¡ trá»‹ tÃ i sáº£n**: Tá»•ng giÃ¡ trá»‹ cÃ²n láº¡i
- **Sá»‘ Ä‘á» xuáº¥t**: Tá»•ng Ä‘á» xuáº¥t cá»§a phÃ²ng
- **GiÃ¡ trá»‹ Ä‘á» xuáº¥t**: Tá»•ng chi phÃ­ Ä‘á» xuáº¥t

#### B. Biá»ƒu Ä‘á»“ cá»™t (Bar Chart)
- So sÃ¡nh giÃ¡ trá»‹ tÃ i sáº£n vÃ  giÃ¡ trá»‹ Ä‘á» xuáº¥t giá»¯a cÃ¡c phÃ²ng ban
- Dá»… dÃ ng nháº­n diá»‡n phÃ²ng nÃ o cÃ³ nhu cáº§u cao

#### C. Pivot Table
- Cho phÃ©p phÃ¢n tÃ­ch linh hoáº¡t
- TÃ¹y chá»‰nh nhÃ³m, lá»c theo nhiá»u tiÃªu chÃ­

---

### **Tab 4: ğŸ“‰ Chi tiáº¿t Kháº¥u hao**

Báº£ng chi tiáº¿t kháº¥u hao theo thÃ¡ng:

| ThÃ¡ng    | Sá»‘ tiá»n kháº¥u hao |
|----------|------------------|
| 01/2025  | 10,000,000 VNÄ   |
| 02/2025  | 12,500,000 VNÄ   |
| ...      | ...              |

**Tá»•ng kháº¥u hao**: Tá»± Ä‘á»™ng tÃ­nh á»Ÿ cuá»‘i báº£ng

---

### **Tab 5: ğŸ’° Chi tiáº¿t Mua sáº¯m**

Báº£ng chi tiáº¿t mua sáº¯m theo thÃ¡ng:

| ThÃ¡ng    | Sá»‘ Ä‘á» xuáº¥t | GiÃ¡ trá»‹ mua sáº¯m  |
|----------|------------|------------------|
| 01/2025  | 5          | 50,000,000 VNÄ   |
| 02/2025  | 3          | 30,000,000 VNÄ   |
| ...      | ...        | ...              |

**Tá»•ng**: Tá»± Ä‘á»™ng tÃ­nh á»Ÿ cuá»‘i báº£ng

---

## ğŸ”§ Cáº¥u trÃºc Ká»¹ thuáº­t

### Models

#### 1. `dashboard.tai.chinh` (Model chÃ­nh)
**Chá»©c nÄƒng**: Tá»•ng há»£p táº¥t cáº£ dá»¯ liá»‡u tÃ i chÃ­nh

**Fields quan trá»ng**:
- `name`: TÃªn dashboard
- `ngay_hien_tai`: NgÃ y hiá»‡n táº¡i (máº·c Ä‘á»‹nh: hÃ´m nay)
- Thá»‘ng kÃª Ä‘á» xuáº¥t: `tong_de_xuat`, `de_xuat_cho_duyet`, `tong_gia_tri_de_xuat`...
- Thá»‘ng kÃª tÃ i sáº£n: `tong_tai_san`, `tai_san_hoat_dong`, `tong_gia_tri_tai_san`...
- Thá»‘ng kÃª kháº¥u hao: `khau_hao_thang_nay`, `khau_hao_quy_nay`, `khau_hao_nam_nay`...
- Sá»• cÃ¡i: `tong_but_toan`, `tong_no`, `tong_co`...
- Cáº£nh bÃ¡o: `canh_bao_tai_san_sap_khau_hao_het`, `canh_bao_de_xuat_qua_han`...

**Computed Fields**: Táº¥t cáº£ field thá»‘ng kÃª Ä‘á»u Ä‘Æ°á»£c tÃ­nh tá»± Ä‘á»™ng
- `@api.depends('ngay_hien_tai')`: Tá»± Ä‘á»™ng cáº­p nháº­t khi ngÃ y thay Ä‘á»•i
- Truy váº¥n real-time tá»« cÃ¡c model: `de_xuat_mua_thiet_bi`, `khau_hao`, `account.move`...

**Action Methods**:
- `action_view_de_xuat()`: Má»Ÿ danh sÃ¡ch Ä‘á» xuáº¥t
- `action_view_de_xuat_cho_duyet()`: Lá»c Ä‘á» xuáº¥t chá» duyá»‡t
- `action_view_tai_san()`: Má»Ÿ danh sÃ¡ch tÃ i sáº£n
- ...

#### 2. `dashboard.depreciation.trend` (Model phá»¥)
**Chá»©c nÄƒng**: LÆ°u dá»¯ liá»‡u xu hÆ°á»›ng kháº¥u hao

**Fields**:
- `dashboard_id`: LiÃªn káº¿t vá»›i dashboard
- `month`: ThÃ¡ng (MM/YYYY)
- `amount`: Sá»‘ tiá»n kháº¥u hao

**Computed**: ÄÆ°á»£c tÃ­nh trong `_compute_trends()` cá»§a dashboard

#### 3. `dashboard.purchase.trend` (Model phá»¥)
**Chá»©c nÄƒng**: LÆ°u dá»¯ liá»‡u xu hÆ°á»›ng mua sáº¯m

**Fields**:
- `dashboard_id`: LiÃªn káº¿t vá»›i dashboard
- `month`: ThÃ¡ng (MM/YYYY)
- `amount`: GiÃ¡ trá»‹ mua sáº¯m
- `count`: Sá»‘ lÆ°á»£ng Ä‘á» xuáº¥t

#### 4. `dashboard.department.distribution` (Model phá»¥)
**Chá»©c nÄƒng**: PhÃ¢n bá»• theo phÃ²ng ban

**Fields**:
- `dashboard_id`: LiÃªn káº¿t vá»›i dashboard
- `department_id`: PhÃ²ng ban
- `tai_san_count`: Sá»‘ tÃ i sáº£n
- `tai_san_value`: GiÃ¡ trá»‹ tÃ i sáº£n
- `de_xuat_count`: Sá»‘ Ä‘á» xuáº¥t
- `de_xuat_value`: GiÃ¡ trá»‹ Ä‘á» xuáº¥t

---

### Views

#### 1. `view_dashboard_tai_chinh_form`
- Type: Form
- Chá»©c nÄƒng: Hiá»ƒn thá»‹ chi tiáº¿t dashboard vá»›i 5 tab
- TÃ­nh nÄƒng: `create="false" edit="false" delete="false"` (chá»‰ Ä‘á»c)

#### 2. `view_dashboard_tai_chinh_kanban`
- Type: Kanban
- Chá»©c nÄƒng: Hiá»ƒn thá»‹ dashboard dáº¡ng tháº»
- TÃ­nh nÄƒng: Click vÃ o cÃ¡c nÃºt Ä‘á»ƒ chuyá»ƒn Ä‘áº¿n danh sÃ¡ch chi tiáº¿t

#### 3. `action_dashboard_tai_chinh`
- Type: `ir.actions.act_window`
- View mode: `kanban,form`
- Má»Ÿ dashboard vá»›i view Kanban máº·c Ä‘á»‹nh

---

### Data Files

#### `data/dashboard_data.xml`
- Táº¡o báº£n ghi dashboard máº·c Ä‘á»‹nh khi cÃ i Ä‘áº·t module
- `noupdate="1"`: Chá»‰ táº¡o 1 láº§n, khÃ´ng ghi Ä‘Ã¨ khi upgrade

---

### Security

#### `security/ir.model.access.csv`
Quyá»n truy cáº­p:
- `dashboard.tai.chinh`: Chá»‰ Ä‘á»c (`perm_read=1`, cÃ¡c quyá»n khÃ¡c = 0)
- `dashboard.depreciation.trend`: Chá»‰ Ä‘á»c
- `dashboard.purchase.trend`: Chá»‰ Ä‘á»c
- `dashboard.department.distribution`: Chá»‰ Ä‘á»c

**LÃ½ do**: Dashboard lÃ  bÃ¡o cÃ¡o tá»•ng há»£p, khÃ´ng cho phÃ©p táº¡o/sá»­a/xÃ³a thá»§ cÃ´ng

---

### Menu Structure

```
ğŸ“Š Quáº£n lÃ½ tÃ i chÃ­nh/káº¿ toÃ¡n
 â””â”€ ğŸ“Š Dashboard TÃ i chÃ­nh (sequence=0) â† Má»šI
 â””â”€ ğŸ’° Äá» xuáº¥t mua thiáº¿t bá»‹ (sequence=1)
     â”œâ”€ Danh sÃ¡ch Ä‘á» xuáº¥t
     â””â”€ Thá»‘ng kÃª Ä‘á» xuáº¥t
 â””â”€ ğŸ“¦ Kháº¥u hao tÃ i sáº£n (sequence=2)
 â””â”€ ğŸ“‰ DÃ²ng kháº¥u hao (sequence=3)
 â””â”€ ğŸ“š BÃºt toÃ¡n kháº¥u hao (sequence=4)
```

---

## ğŸ“Š SÆ¡ Ä‘á»“ Luá»“ng Dá»¯ liá»‡u

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DASHBOARD TÃ€I CHÃNH                      â”‚
â”‚                   (dashboard.tai.chinh)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                         â”‚
         â–¼                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Äá»€ XUáº¤T MUA THIáº¾T Bá»Šâ”‚                  â”‚   TÃ€I Sáº¢N & KHáº¤U HAOâ”‚
â”‚ (de_xuat_mua_thiet_bi)â”‚                  â”‚     (khau_hao)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                         â”‚
         â”‚                                         â”‚
         â”œâ”€ Tá»•ng sá»‘ Ä‘á» xuáº¥t                        â”œâ”€ Tá»•ng tÃ i sáº£n
         â”œâ”€ Theo tráº¡ng thÃ¡i                        â”œâ”€ Theo tráº¡ng thÃ¡i
         â”œâ”€ Tá»•ng giÃ¡ trá»‹                           â”œâ”€ GiÃ¡ trá»‹ ban Ä‘áº§u
         â”œâ”€ Xu hÆ°á»›ng 12 thÃ¡ng                      â”œâ”€ Kháº¥u hao tÃ­ch lÅ©y
         â””â”€ PhÃ¢n bá»• phÃ²ng ban                      â”œâ”€ GiÃ¡ trá»‹ cÃ²n láº¡i
                                                   â”œâ”€ Kháº¥u hao theo ká»³
                                                   â””â”€ PhÃ¢n bá»• phÃ²ng ban
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Sá»” CÃI & BÃšT TOÃN â”‚
                  â”‚   (account.move)    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€ Tá»•ng bÃºt toÃ¡n
                              â”œâ”€ BÃºt toÃ¡n theo ká»³
                              â”œâ”€ Tá»•ng ná»£
                              â””â”€ Tá»•ng cÃ³
```

---

## ğŸ“ˆ Biá»ƒu Ä‘á»“ TÃ­nh toÃ¡n

### 1. TÃ­nh Kháº¥u hao theo Ká»³

```
Kháº¥u hao thÃ¡ng nÃ y = SUM(khau_hao.line.amount)
                     WHERE date >= start_of_month
                     AND date <= end_of_month
                     AND state = 'depreciated'

Kháº¥u hao quÃ½ nÃ y   = SUM(khau_hao.line.amount)
                     WHERE date >= start_of_quarter
                     AND date <= end_of_quarter
                     AND state = 'depreciated'

Kháº¥u hao nÄƒm nÃ y   = SUM(khau_hao.line.amount)
                     WHERE date >= start_of_year
                     AND date <= end_of_year
                     AND state = 'depreciated'
```

### 2. TÃ­nh GiÃ¡ trá»‹ TÃ i sáº£n

```
GiÃ¡ trá»‹ cÃ²n láº¡i = GiÃ¡ trá»‹ ban Ä‘áº§u - Kháº¥u hao tÃ­ch lÅ©y

Tá»•ng giÃ¡ trá»‹ cÃ²n láº¡i = SUM(khau_hao.gia_tri_con_lai)
                       FOR ALL khau_hao records
```

### 3. Cáº£nh bÃ¡o

```
TÃ i sáº£n sáº¯p kháº¥u hao háº¿t = COUNT(khau_hao)
                           WHERE (gia_tri_con_lai / gia_tri) * 100 < 10
                           AND state = 'active'

Äá» xuáº¥t quÃ¡ háº¡n = COUNT(de_xuat_mua_thiet_bi)
                  WHERE ngay_du_kien_nhan < TODAY
                  AND state IN ('submitted', 'approved')
```

---

## ğŸ¨ TÃ­nh nÄƒng TÆ°Æ¡ng tÃ¡c

### 1. Tá»« Kanban View
- Click vÃ o sá»‘ "Tá»•ng Ä‘á» xuáº¥t" â†’ Má»Ÿ danh sÃ¡ch táº¥t cáº£ Ä‘á» xuáº¥t
- Click vÃ o "Chá» duyá»‡t" â†’ Lá»c Ä‘á» xuáº¥t chá» phÃª duyá»‡t
- Click vÃ o "Tá»•ng tÃ i sáº£n" â†’ Má»Ÿ danh sÃ¡ch tÃ i sáº£n
- Click vÃ o "Hoáº¡t Ä‘á»™ng" â†’ Lá»c tÃ i sáº£n Ä‘ang hoáº¡t Ä‘á»™ng

### 2. Tá»« Form View
- Táº¥t cáº£ biá»ƒu Ä‘á»“ cÃ³ thá»ƒ zoom, pan
- Pivot table cho phÃ©p group, filter tÃ¹y chá»‰nh
- CÃ³ thá»ƒ xuáº¥t bÃ¡o cÃ¡o Excel/PDF tá»« cÃ¡c tab

### 3. Cáº£nh bÃ¡o
- Hiá»ƒn thá»‹ ná»•i báº­t khi cÃ³ váº¥n Ä‘á»
- MÃ u vÃ ng: Cáº£nh bÃ¡o (warning)
- Hiá»ƒn thá»‹ sá»‘ lÆ°á»£ng cá»¥ thá»ƒ

---

## ğŸš€ Quy trÃ¬nh Sá»­ dá»¥ng

### BÆ°á»›c 1: Truy cáº­p Dashboard
```
Menu: Quáº£n lÃ½ tÃ i chÃ­nh/káº¿ toÃ¡n > ğŸ“Š Dashboard TÃ i chÃ­nh
```

### BÆ°á»›c 2: Xem Tá»•ng quan (Kanban View)
- Kiá»ƒm tra cáº£nh bÃ¡o (náº¿u cÃ³)
- Xem cÃ¡c chá»‰ sá»‘ chÃ­nh: Ä‘á» xuáº¥t, tÃ i sáº£n, kháº¥u hao
- Click vÃ o sá»‘ liá»‡u Ä‘á»ƒ xem chi tiáº¿t

### BÆ°á»›c 3: PhÃ¢n tÃ­ch Chi tiáº¿t (Form View)
- Má»Ÿ tab "Tá»•ng quan" Ä‘á»ƒ xem Ä‘áº§y Ä‘á»§ sá»‘ liá»‡u
- Chuyá»ƒn sang tab "Xu hÆ°á»›ng" Ä‘á»ƒ xem biá»ƒu Ä‘á»“ 12 thÃ¡ng
- Tab "PhÃ²ng ban" Ä‘á»ƒ phÃ¢n tÃ­ch theo Ä‘Æ¡n vá»‹

### BÆ°á»›c 4: Xuáº¥t BÃ¡o cÃ¡o
- Tá»« cÃ¡c tab, chá»n "Print" hoáº·c "Export"
- Chá»n Ä‘á»‹nh dáº¡ng: PDF, Excel, CSV

---

## âš™ï¸ Cáº¥u hÃ¬nh vÃ  TÃ¹y chá»‰nh

### 1. ThÃªm Chá»‰ sá»‘ má»›i
**VÃ­ dá»¥**: ThÃªm "Kháº¥u hao tuáº§n nÃ y"

**BÆ°á»›c 1**: ThÃªm field vÃ o model
```python
# File: models/dashboard_tai_chinh.py
khau_hao_tuan_nay = fields.Float(
    string='Kháº¥u hao tuáº§n nÃ y',
    compute='_compute_khau_hao_stats'
)
```

**BÆ°á»›c 2**: Cáº­p nháº­t hÃ m compute
```python
def _compute_khau_hao_stats(self):
    # ... existing code ...
    
    # Tuáº§n nÃ y
    start_week = today - relativedelta(days=today.weekday())
    end_week = start_week + relativedelta(days=6)
    lines_tuan = KhauHaoLine.search([
        ('date', '>=', start_week),
        ('date', '<=', end_week),
        ('state', '=', 'depreciated')
    ])
    record.khau_hao_tuan_nay = sum(lines_tuan.mapped('amount'))
```

**BÆ°á»›c 3**: ThÃªm vÃ o view
```xml
<!-- File: views/dashboard_tai_chinh.xml -->
<field name="khau_hao_tuan_nay" widget="monetary"/>
```

### 2. TÃ¹y chá»‰nh Biá»ƒu Ä‘á»“
- Äá»•i loáº¡i biá»ƒu Ä‘á»“: `type="line"` â†’ `type="bar"`, `type="pie"`
- ThÃªm field: `<field name="new_field" type="measure"/>`
- Group theo field khÃ¡c: `<field name="category" type="row"/>`

### 3. ThÃªm Filter/Group
```xml
<search string="Search Dashboard">
    <filter name="this_month" string="ThÃ¡ng nÃ y" 
            domain="[('ngay_hien_tai', '>=', context_today().strftime('%Y-%m-01'))]"/>
    <group string="Group By">
        <filter name="group_month" string="ThÃ¡ng" context="{'group_by':'ngay_hien_tai:month'}"/>
    </group>
</search>
```

---

## ğŸ“ Ghi chÃº Ká»¹ thuáº­t

### 1. Performance
- CÃ¡c computed field Ä‘Æ°á»£c cache tá»± Ä‘á»™ng bá»Ÿi Odoo
- Sá»­ dá»¥ng `store=True` cho cÃ¡c field quan trá»ng
- One2many cho trend Ä‘Æ°á»£c compute on-the-fly (khÃ´ng store)

### 2. Security
- Dashboard chá»‰ Ä‘á»c, khÃ´ng cho phÃ©p sá»­a/xÃ³a
- Dá»¯ liá»‡u Ä‘Æ°á»£c láº¥y theo quyá»n cá»§a user hiá»‡n táº¡i
- TuÃ¢n thá»§ record rules cá»§a Odoo

### 3. Upgrade
- Khi upgrade module, data khÃ´ng bá»‹ ghi Ä‘Ã¨ (`noupdate="1"`)
- Náº¿u muá»‘n reset dashboard, xÃ³a báº£n ghi vÃ  upgrade láº¡i

---

## ğŸ”® TÃ­nh nÄƒng Má»Ÿ rá»™ng TÆ°Æ¡ng lai

### 1. Dashboard Äá»™ng
- Cho phÃ©p user tÃ¹y chá»‰nh hiá»ƒn thá»‹
- Drag & drop widgets
- LÆ°u cáº¥u hÃ¬nh cÃ¡ nhÃ¢n

### 2. ThÃ´ng bÃ¡o Real-time
- Cáº£nh bÃ¡o qua email khi cÃ³ váº¥n Ä‘á»
- Notification trong Odoo
- TÃ­ch há»£p vá»›i calendar

### 3. So sÃ¡nh Ká»³
- So sÃ¡nh thÃ¡ng nÃ y vá»›i thÃ¡ng trÆ°á»›c
- % tÄƒng/giáº£m
- Biá»ƒu Ä‘á»“ variance

### 4. Dá»± Ä‘oÃ¡n (AI/ML)
- Dá»± Ä‘oÃ¡n chi phÃ­ kháº¥u hao 6 thÃ¡ng tá»›i
- Gá»£i Ã½ thá»i Ä‘iá»ƒm mua sáº¯m tá»‘i Æ°u
- PhÃ¡t hiá»‡n báº¥t thÆ°á»ng

### 5. Export NÃ¢ng cao
- Tá»± Ä‘á»™ng gá»­i bÃ¡o cÃ¡o Ä‘á»‹nh ká»³
- Templates bÃ¡o cÃ¡o cÃ³ sáºµn
- TÃ­ch há»£p vá»›i BI tools (Power BI, Tableau)

---

## ğŸ“š TÃ i liá»‡u LiÃªn quan

- [README Module QLTC](../README.md)
- [TÃ­nh nÄƒng Äá» xuáº¥t Mua thiáº¿t bá»‹](../FEATURE_SUMMARY.md)
- [SÆ¡ Ä‘á»“ Äá» xuáº¥t](../DIAGRAM_DE_XUAT_MUA_THIET_BI.md)
- [Odoo Dashboard Documentation](https://www.odoo.com/documentation/16.0/developer/tutorials/dashboards.html)

---

## âœ… Checklist Triá»ƒn khai

- [x] Táº¡o model `dashboard.tai.chinh`
- [x] Táº¡o model phá»¥ cho biá»ƒu Ä‘á»“
- [x] Implement computed fields
- [x] Táº¡o action methods
- [x] Táº¡o view Kanban
- [x] Táº¡o view Form vá»›i 5 tabs
- [x] Táº¡o menu vÃ  action
- [x] Cáº¥u hÃ¬nh security
- [x] Táº¡o data máº«u
- [x] Cáº­p nháº­t `__manifest__.py`
- [x] Viáº¿t tÃ i liá»‡u

---

## ğŸ“ HÆ°á»›ng dáº«n Test

### Test 1: Hiá»ƒn thá»‹ Dashboard
1. Upgrade module `qltc`
2. VÃ o menu: Quáº£n lÃ½ tÃ i chÃ­nh/káº¿ toÃ¡n > Dashboard TÃ i chÃ­nh
3. Kiá»ƒm tra hiá»ƒn thá»‹ Kanban view
4. Click vÃ o card Ä‘á»ƒ má»Ÿ Form view

### Test 2: Thá»‘ng kÃª ÄÃºng
1. Táº¡o vÃ i Ä‘á» xuáº¥t mua vá»›i tráº¡ng thÃ¡i khÃ¡c nhau
2. Táº¡o vÃ i tÃ i sáº£n vá»›i kháº¥u hao
3. Refresh dashboard
4. So sÃ¡nh sá»‘ liá»‡u vá»›i thá»±c táº¿

### Test 3: Biá»ƒu Ä‘á»“
1. Má»Ÿ Form view
2. Chuyá»ƒn sang tab "Xu hÆ°á»›ng"
3. Kiá»ƒm tra biá»ƒu Ä‘á»“ Line vÃ  Bar hiá»ƒn thá»‹ Ä‘Ãºng
4. Hover vÃ o cÃ¡c Ä‘iá»ƒm Ä‘á»ƒ xem tooltip

### Test 4: TÆ°Æ¡ng tÃ¡c
1. Click vÃ o "Tá»•ng Ä‘á» xuáº¥t" á»Ÿ Kanban view
2. Kiá»ƒm tra má»Ÿ Ä‘Ãºng danh sÃ¡ch
3. Click vÃ o "Chá» duyá»‡t"
4. Kiá»ƒm tra filter Ä‘Ãºng

### Test 5: Cáº£nh bÃ¡o
1. Táº¡o Ä‘á» xuáº¥t quÃ¡ háº¡n
2. Táº¡o tÃ i sáº£n kháº¥u hao gáº§n háº¿t
3. Refresh dashboard
4. Kiá»ƒm tra cáº£nh bÃ¡o hiá»ƒn thá»‹

---

## ğŸ› Troubleshooting

### Lá»—i: Dashboard khÃ´ng hiá»ƒn thá»‹
**NguyÃªn nhÃ¢n**: ChÆ°a cÃ³ báº£n ghi dashboard  
**Giáº£i phÃ¡p**: 
```python
# Cháº¡y trong Odoo shell
dashboard = env['dashboard.tai.chinh'].create({'name': 'Dashboard TÃ i chÃ­nh'})
```

### Lá»—i: Biá»ƒu Ä‘á»“ trá»‘ng
**NguyÃªn nhÃ¢n**: KhÃ´ng cÃ³ dá»¯ liá»‡u 12 thÃ¡ng  
**Giáº£i phÃ¡p**: Táº¡o dá»¯ liá»‡u máº«u hoáº·c chá» Ä‘á»§ dá»¯ liá»‡u

### Lá»—i: Access denied
**NguyÃªn nhÃ¢n**: Thiáº¿u quyá»n  
**Giáº£i phÃ¡p**: Kiá»ƒm tra file `ir.model.access.csv`

---

**TÃ¡c giáº£**: Module QLTC Team  
**NgÃ y táº¡o**: 2026-01-08  
**PhiÃªn báº£n**: 1.0  
**Odoo Version**: 16.0
